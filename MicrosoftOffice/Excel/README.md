# Excelについて

## Excelショートカット  

- `F4` ...数式の絶対参照を設定する  
- `F12` ...名前を付けて保存  
- `Tab` ...右のセルに移動する(左のセルの場合はShift + Tab)  
- `Enter` ...下のセルに移動する(上のセルの場合はShift + Enter)  
- `Ctrl + A` ...全セルを選択する  
- `Ctrl + C` ...範囲指定した文字やセルをコピーする  
- `Ctrl + D` ...1つ上のセルをコピーして、コピーした内容を選択したセルに貼り付ける  
              選択範囲の中で、一番上の行にある値を一番下までコピーして貼り付ける  
- `Ctrl + F` ...「検索と置換」の「検索」タブを表示する  
- `Ctrl + H` ...「検索と置換」の「置換」タブを表示する  
- `Ctrl + N` ...Excelファイルを新規作成する  
- `Ctrl + O` ...作成済みのExcelファイルを開く  
- `Ctrl + P` ...印刷プレビューの確認および印刷  
- `Ctrl + S` ...作業中のファイルを上書き保存する  
- `Ctrl + V` ...コピーしたり切り取ったデータを貼り付ける  
- `Ctrl + Z` ...直前の操作を元に戻す  
- `Ctrl + \` ...選択している範囲において、値が入っているセルを選択する  
- `Ctrl + [` ...選択範囲において、数式によって直接参照されているセルをすべて選択する  
- `Ctrl + Tab` ...次のタブ、または次のブックに切り替える  
- `Alt + Tab` ...開かれているウィンドウのリストを表示する  
- `ALt + 矢印or図形ドラッグ` ...セルに合わせてオブジェクトの位置が調整される  

---

## Excelチートシート  

### 関数

- `COUNT(値1, 値2 …)` ...数値や日付のセルを数える  
  - 使用例  
    - =COUNT(B2:B4) ...セルの範囲「B2」～「B4」のセルを数える  
- `COUNTA(値1, 値2 …)` ...空白でないセルを数える  
  - 使用例  
    - =COUNTA(B2:B4, C2:C4) ...セルの範囲「B2」～「B4」と「C2」～「C4」のセルを数える  
  - 空白文字が入っているセルもカウントされる。  
- `COUNTIF(範囲, 条件)` ...条件に一致するセルを数える  
  - 使用例  
    - =COUNTIF(B2:B5,C2) ...セル「C2」の値と同じセルを数える  
    - =COUNTIF(B2:B5,"<>0") ...「0」以外のセルを数える  
- `COUNTIFS(範囲1, 条件1, 範囲2, 条件2 …)` ...複数の条件に一致するセルを数える  
  - 使用例  
    - =COUNTIFS(B3:B6,"エクセル",C3:C6,">=100") ...分類が「エクセル」で値が「100 以上」のセルを数える  

- `SUM(数値1, 数値2 …)` ...合計を求める  
  - 使用例  
    - =SUM(B2:B4)セルの範囲「B2」～「B4」の合計を求める。  
- `SUMIF(範囲, 条件, 合計範囲)` ...条件に一致するセルの合計を求める  
  - 使用例  
    - =SUMIF(B3:B6,">=100") ...値が「100」以上の合計を求める  
    - =SUMIF(B3:B6,D3,C3:C6) ...分類がセル「D3」と同じ値の合計を求める  
  - 合計範囲は省略して記述可能  
- `SUMIFS(合計範囲, 条件範囲1, 条件1, 条件範囲2, 条件2 …)` ...複数の条件に一致するセルの合計を求める  
  - 使用例  
    - =SUMIFS(C3:C6,B3:B6,D3,C3:C6,">=100") ...分類がセル「D3」と同じで、値が「100」以上の合計を求める  

- `IF(条件, TRUE の処理, FALSE の処理)` ...条件により処理を分ける  
  - 使用例  
    - =IF(B3>=80,"合格","不合格") ...セル「B3」が 80 以上なら「合格」それ以外なら「不合格」と表示する  
  - 検索の型は省略して記述可能。(省略した場合はFALSEを返す)  
- `IFS(条件1, TRUE の処理1, 条件2, TRUE の処理2 …)` ...複数の条件ごとに処理を分岐させる  
  - 使用例
    - =IFS(B3=100,"A",B3>=80,"B",B3>=50,"C",TRUE,"D")  
      ... セル「B3」が 100 なら「A」、セル「B3」が 80 以上なら「B」、セル「B3」が 50 以上なら「C」、それ以外のときは「D」と表示する。  

- `LOOKUP(検索値, 検索範囲, 対応範囲)` ...検索する値に対応した値を取得する  
  - 使用例  
    - =LOOKUP(B8,B$2:B5) ...セル「B8」に指定した値に近い値をセル「B2」～「B5」の中から取得する  
    - =LOOKUP(B7,B2:B4,C2:C4) ...B列から検索し、対応した値を C列から取得する  
  - 対応範囲は省略して記述可能  
- `HLOOKUP(検索値, 範囲, 行番号, 検索の型)` ...検索する値に対応した値を指定の**行**から取得する  
  - 使用例  
    - =HLOOKUP(B7,B2:D4,C7,FALSE) ...セル「B7」に指定した値を、「B2」～「D4」の中の指定した行(C7)から取得する  
  - 検索の型は省略して記述可能  
- `VLOOKUP(検索値, 範囲, 列番号, 検索の型)` ...検索する値に対応した値を指定の**列**から取得する  
  - 使用例  
    - =VLOOKUP(B7,B2:D4,C7,FALSE) ...セル「B7」に指定した値を、「B2」～「D4」の中の指定した列(C7)から取得する  
  - 検索の型は省略して記述可能  

---

## Excel マクロ機能について  

### 機能を有効にする方法  

1. エクセルを開き、`ファイル` → `オプション` → `リボンのユーザー設定`を選択  
2. `開発`にチェックを入れて`OK`で完了。`開発`のタブが出ていればOK  

### マクロの使い方  

1. エクセルの`開発` → `マクロの記録`をクリック  
2. マクロ名(任意の文字列)を入力し`OK` → 記録開始（マクロ化させたい作業を記録させる）  
  - 例)特定の行にフィルターをかける、セルを指定する等  
3. 終わるときは`開発` → `記録終了`を押す  

### 補足  

- `*.xlsm`のファイルは、マクロ有効ブックであることを表している。  